<!DOCTYPE html>
<!--
Created using JS Bin
http://jsbin.com

Copyright (c) 2025 by anonymous (http://jsbin.com/nunezofaxa/1/edit)

Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Tập Điền Từ: Passé Composé / Imparfait</title>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .quiz-container {
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
            padding: 30px 40px;
        }

        .quiz-header {
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .quiz-header h1 {
            color: #2c3e50;
            margin: 0;
            font-size: 28px;
        }

        .info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            font-size: 16px;
            color: #555;
            flex-wrap: wrap;
            gap: 20px;
        }

        #score-container {
            background-color: #e67e22;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
        }

        .special-chars-bar {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .char-btn {
            background-color: #f1f1f1;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
        }
        .char-btn:hover {
            background-color: #e0e0e0;
        }
        .char-btn:active {
            transform: scale(0.95);
        }
        
        .paragraph-container {
            font-size: 1.2rem;
            line-height: 3;
            color: #34495e;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px 8px 0 0;
            border: 1px solid #e9ecef;
            border-bottom: none;
        }
        
        .translation-container {
            font-size: 1rem;
            line-height: 1.8;
            color: #555;
            background-color: #f8f9fa;
            padding: 15px 20px;
            border-radius: 0 0 8px 8px;
            border: 1px solid #e9ecef;
            border-top: 1px dashed #ccc;
            font-style: italic;
            margin-bottom: 20px;
        }

        .verb-input {
            font-family: 'Roboto', sans-serif;
            font-size: 1.1rem;
            border: none;
            border-bottom: 2px solid #3498db;
            padding: 4px 6px;
            text-align: center;
            width: 140px;
            transition: all 0.2s ease-in-out;
            background-color: transparent;
        }
        .verb-input:focus {
            outline: none;
            border-bottom: 2px solid #e67e22;
        }
        .verb-input.correct {
            border-bottom-color: #2ecc71;
            color: #2ecc71;
        }
        .verb-input.incorrect {
            border-bottom-color: #e74c3c;
            color: #e74c3c;
        }

        .feedback-span {
            font-size: 0.9rem;
            margin-left: 5px;
        }
        .feedback-span .correct-answer {
            font-weight: bold;
            color: #27ae60;
        }
        
        .feedback-explanation {
            font-size: 1rem;
            color: #34495e;
            background-color: #e8f4fd;
            border-left: 4px solid #0366d6;
            padding: 15px;
            margin-top: 20px;
            display: none;
            line-height: 1.6;
        }
        
        .feedback-explanation strong {
            font-size: 1.1rem;
        }

        .check-all-btn {
            display: block;
            width: 100%;
            padding: 18px;
            font-size: 18px;
            font-weight: bold;
            color: #fff;
            background: linear-gradient(90deg, #e67e22, #d35400);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 30px;
        }
        .check-all-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

    </style>
</head>
<body>

    <div class="quiz-container">
        <header class="quiz-header">
            <h1>Bài Tập Kể Chuyện: Passé Composé / Imparfait</h1>
            <div class="info-bar">
                <span>Enseignant: <strong>Nguyễn Hoàng Vũ</strong></span>
                <div id="score-container">
                    Điểm: <span id="score-value">0/8</span>
                </div>
            </div>
        </header>

        <form id="quiz-form" onsubmit="return false;">
            <p style="text-align: center; font-style: italic; color: #555; margin-bottom: 20px;">
                Hoàn thành câu chuyện sau bằng cách chia các động từ trong ngoặc ở thì Passé Composé hoặc Imparfait.
            </p>

            <div id="special-chars" class="special-chars-bar">
                <button type="button" class="char-btn">à</button>
                <button type="button" class="char-btn">â</button>
                <button type="button" class="char-btn">é</button>
                <button type="button" class="char-btn">è</button>
                <button type="button" class="char-btn">ê</button>
                <button type="button" class="char-btn">ë</button>
                <button type="button" class="char-btn">î</button>
                <button type="button" class="char-btn">ï</button>
                <button type="button" class="char-btn">ô</button>
                <button type="button" class="char-btn">û</button>
                <button type="button" class="char-btn">ù</button>
                <button type="button" class="char-btn">ç</button>
            </div>

            <div class="paragraph-container">
                Ce matin, Yannik <input type="text" id="q1_verb1" class="verb-input" placeholder="(dormir)"> <span class="feedback-span" id="q1_feedback1"></span> quand le téléphone <input type="text" id="q1_verb2" class="verb-input" placeholder="(sonner)"> <span class="feedback-span" id="q1_feedback2"></span>. Il <input type="text" id="q1_verb3" class="verb-input" placeholder="(courir)"> <span class="feedback-span" id="q1_feedback3"></span> jusqu'à l'appareil, il <input type="text" id="q1_verb4" class="verb-input" placeholder="(répondre)"> <span class="feedback-span" id="q1_feedback4"></span> mais il <input type="text" id="q1_verb5" class="verb-input" placeholder="(entendre)"> <span class="feedback-span" id="q1_feedback5"></span> une voix qu'il ne <input type="text" id="q1_verb6" class="verb-input" placeholder="(connaître)"> <span class="feedback-span" id="q1_feedback6"></span> pas. C' <input type="text" id="q1_verb7" class="verb-input" placeholder="(être)"> <span class="feedback-span" id="q1_feedback7"></span> une erreur. Il <input type="text" id="q1_verb8" class="verb-input" placeholder="(retourner)"> <span class="feedback-span" id="q1_feedback8"></span> se coucher.
            </div>
            <div class="translation-container">
                Sáng nay, Yannik (đang ngủ) thì điện thoại (reo). Anh ấy (chạy) đến chỗ máy, anh ấy (trả lời) nhưng anh ấy (nghe thấy) một giọng nói mà anh ấy không (biết). Đó (là) một sự nhầm lẫn. Anh ấy (quay trở lại) giường ngủ.
            </div>
            <div class="feedback-explanation" id="q1_explanation"></div>
            
            <button id="check-all-btn" class="check-all-btn">Kiểm tra tất cả</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const solution = {
                blanks: {
                    q1_verb1: 'dormait',
                    q1_verb2: 'a sonné',
                    q1_verb3: 'a couru',
                    q1_verb4: 'a répondu',
                    q1_verb5: 'a entendu',
                    q1_verb6: 'connaissait',
                    q1_verb7: "était",
                    q1_verb8: ['est retourné', 'est retourne']
                },
                explanation: `
                    <strong>Phân tích:</strong><br>
                    - <strong>dormait</strong> (Imparfait): Hành động nền, đang diễn ra (Yannik đang ngủ).<br>
                    - <strong>a sonné</strong> (Passé Composé): Hành động bất chợt xen vào làm gián đoạn giấc ngủ.<br>
                    - <strong>a couru, a répondu, a entendu</strong> (Passé Composé): Chuỗi các hành động chính, kế tiếp nhau.<br>
                    - <strong>connaissait, C'était</strong> (Imparfait): Dùng để miêu tả (giọng nói không quen, đó là một sự nhầm lẫn), không phải là hành động.<br>
                    - <strong>est retourné</strong> (Passé Composé): Hành động chính cuối cùng để kết thúc câu chuyện.
                `
            };

            const checkButton = document.getElementById('check-all-btn');
            const scoreValueElement = document.getElementById('score-value');
            const totalBlanks = Object.keys(solution.blanks).length;
            let currentScore = 0;
            let lastActiveInput = null;

            // --- Logic for Special Character Buttons ---
            const charButtons = document.querySelectorAll('.char-btn');
            const verbInputs = document.querySelectorAll('.verb-input');

            // Track the last focused input field
            verbInputs.forEach(input => {
                input.addEventListener('focus', (event) => {
                    lastActiveInput = event.target;
                });
            });
            
            // Add click event to each character button
            charButtons.forEach(button => {
                button.addEventListener('click', () => {
                    if (lastActiveInput) {
                        const charToInsert = button.textContent;
                        const input = lastActiveInput;
                        const startPos = input.selectionStart;
                        const endPos = input.selectionEnd;
                        const originalValue = input.value;
                        
                        // Insert the character
                        input.value = originalValue.substring(0, startPos) + charToInsert + originalValue.substring(endPos);
                        
                        // Move cursor and re-focus
                        const newPos = startPos + 1;
                        input.selectionStart = newPos;
                        input.selectionEnd = newPos;
                        input.focus();
                    }
                });
            });


            // --- Logic for Checking Answers ---
            checkButton.addEventListener('click', () => {
                currentScore = 0;
                
                const explanationElement = document.getElementById('q1_explanation');
                
                Object.keys(solution.blanks).forEach(blankId => {
                    const inputElement = document.getElementById(blankId);
                    const feedbackElement = document.getElementById(blankId.replace('verb', 'feedback'));
                    const userAnswer = inputElement.value.trim();
                    const correctAnswer = solution.blanks[blankId];

                    let correctAnswers = Array.isArray(correctAnswer) ? correctAnswer : [correctAnswer];
                    if (correctAnswer.toLowerCase() === "c'était") {
                        correctAnswers.push("c'était");
                    }

                    if (correctAnswers.map(ans => ans.toLowerCase()).includes(userAnswer.toLowerCase())) {
                        currentScore++;
                        inputElement.classList.add('correct');
                        feedbackElement.innerHTML = '✔️';
                    } else {
                        inputElement.classList.add('incorrect');
                        feedbackElement.innerHTML = `❌ <span class="correct-answer">${correctAnswers[0]}</span>`;
                    }
                    inputElement.disabled = true;
                });
                
                explanationElement.innerHTML = solution.explanation;
                explanationElement.style.display = 'block';

                scoreValueElement.textContent = `${currentScore}/${totalBlanks}`;
                checkButton.disabled = true;
            });
        });
    </script>
</body>
</html>